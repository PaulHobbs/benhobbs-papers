<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Urban Heat Mitigation Trade-offs</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- MathJax Configuration -->
    <script>
        MathJax = {
          tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true
          },
          svg: {
            fontCache: 'global'
          }
        };
        </script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: sans-serif;
            line-height: 1.6;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        h1, h2, h3 {
            color: #2c3e50;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }
        h1 {
            margin-top: 0;
        }
        code {
            background-color: #f8f9fa;
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }
        .interactive-section {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .slider-label {
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: block;
        }
        canvas {
            max-width: 100%;
            margin-top: 1rem;
        }
        .caption {
            font-size: 0.9em;
            color: #6c757d;
            text-align: center;
            margin-top: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .term {
            font-weight: bold;
            color: #0d6efd; /* Bootstrap primary blue */
        }
        .wiki-link {
            font-size: 0.8em;
            color: #6c757d;
            text-decoration: none;
        }
        .wiki-link:hover {
            text-decoration: underline;
        }
        .alert-info {
            background-color: #e0f7fa; /* Lighter blue */
            border-color: #b2ebf2;
            color: #00796b; /* Darker teal */
        }
        .highlight {
             background-color: #fff9c4; /* Light yellow */
             padding: 2px 4px;
             border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">

        <h1>Cooling Our Cities: Navigating the Complex Choices of Urban Heat Mitigation</h1>
        <p class="lead">Cities are getting hotter, due to both global climate change and the <a class="term" href="https://en.wikipedia.org/wiki/Urban_heat_island" target="_blank">Urban Heat Island (UHI)</a> effect. This isn't just uncomfortable; extreme heat poses serious health risks, increasing illness and mortality, especially during heatwaves. How can cities adapt and protect their residents?</p>

        <p>This post explores the core ideas from the paper "Distributional outcomes of urban heat island reduction pathways under climate extremes" by Eyni et al. (2025). The paper uses a sophisticated modeling tool, <span class="term">City-HEAT</span>, to analyze different strategies for cooling Baltimore, Maryland. The challenge isn't just *if* we can cool the city, but how to do it in a way that is cost-effective, saves the most lives, is fair to all communities, and considers environmental co-benefits, all while facing an uncertain future climate.</p>

        <h2>The Balancing Act: Multiple Conflicting Goals</h2>
        <p>Imagine you're a city planner. You have a limited budget and several ways to combat urban heat:</p>
        <ul>
            <li><strong>Greening:</strong> Planting trees provides shade and cooling through evapotranspiration.</li>
            <li><strong>Cool Surfaces:</strong> Installing reflective ('cool') roofs and pavements absorbs less sunlight.</li>
            <li><strong>Cooling Centers:</strong> Providing air-conditioned public spaces during heat waves reduces exposure for vulnerable people.</li>
        </ul>
        <p>Which strategies should you choose, and where should you implement them? It's complicated because you have multiple goals, and they often conflict:</p>
        <ol>
            <li><strong>Minimize Cost:</strong> Implementing these strategies costs money (installation, maintenance).</li>
            <li><strong>Minimize Heat-Related Deaths:</strong> The primary goal is to save lives.</li>
            <li><strong>Minimize Inequality:</strong> Heat doesn't affect everyone equally. Vulnerable populations (elderly, low-income) often live in hotter neighborhoods (<a class="term" href="https://en.wikipedia.org/wiki/Community_Statistical_Area" target="_blank">CSAs</a> in Baltimore's case) with fewer resources (like AC or trees). An equitable strategy should reduce health disparities between neighborhoods.</li>
            <li><strong>Maximize CO2 Reduction:</strong> Trees absorb CO2, providing a climate co-benefit.</li>
            <li><strong>Maximize Reliability:</strong> Strategies should work well even in the worst heatwave years.</li>
        </ol>
        <p>Doing well on one objective often means doing worse on another. Spending more money (worse cost) might save more lives (better mortality reduction). But where you spend that money dramatically affects inequality.</p>

        <h2>Visualizing the Trade-offs: The Pareto Frontier</h2>
        <p>The City-HEAT model, using a technique called <a class="term" href="https://en.wikipedia.org/wiki/Multi-objective_optimization" target="_blank">Multi-Objective Optimization</a>, doesn't find a single "best" solution. Instead, it identifies a set of <a class="term" href="https://en.wikipedia.org/wiki/Pareto_efficiency" target="_blank">Pareto Optimal</a> solutions (or pathways). These are strategies where you can't improve one objective without making another objective worse. This set of solutions forms a "frontier" representing the best possible trade-offs.</p>

        <div class="interactive-section">
            <h3>Explore the Trade-off Space</h3>
            <p>The charts below show the relationship between key objectives for the different mitigation pathways found by City-HEAT. Each point represents a potential 50-year strategy for Baltimore. Hover over points to see hypothetical details. (Note: Data is illustrative, based on trends in the paper's Figure 2).</p>
            <div class="row">
                <div class="col-md-6">
                    <canvas id="costMortalityChart"></canvas>
                    <p class="caption">Trade-off between Total Cost and Lives Saved (Mortality Reduction). Generally, spending more saves more lives, but with diminishing returns (higher unit cost).</p>
                </div>
                <div class="col-md-6">
                    <canvas id="mortalityEquityChart"></canvas>
                    <p class="caption">Trade-off between Lives Saved and Equity (lower mortality difference between neighborhoods is better). More expensive, high-mortality-reduction strategies don't always yield the best equity outcomes.</p>
                </div>
            </div>
             <p><small><strong>Strategy Types (Illustrative):</strong> <span style="color: #36A2EB;">■</span> Balanced/Moderate, <span style="color: #4BC0C0;">■</span> Greening Focused, <span style="color: #FFCE56;">■</span> Infrastructure Focused (Cool Surfaces), <span style="color: #FF6384;">■</span> High Investment (All Strategies)</small></p>
       </div>

        <h2>The Surprising Story of Trees and Equity</h2>
        <p>Intuitively, planting trees seems like a universally good solution – they cool, absorb CO2, and improve aesthetics. City planners often favor greening strategies. However, the City-HEAT model revealed a counter-intuitive finding: <span class="highlight">pathways heavily focused on tree planting were often less effective at reducing health *inequalities* compared to more balanced or infrastructure-focused approaches.</span></p>
        <p>Why? Several factors contribute:</p>
        <ul>
            <li><strong>Planting Site Availability:</strong> The model considered existing land cover data. Densely built, often lower-income, neighborhoods simply had less available space (parks, yards, unpaved areas) to plant large numbers of new trees without significant (and expensive) demolition or retrofitting.</li>
            <li><strong>Cost Structure:</strong> If contracts reward planting trees on a cost-per-tree basis, it encourages planting in easier, often more affluent areas with existing green space, rather than tackling difficult urban core sites.</li>
            <li><strong>Demographics vs. Heat:</strong> While low-income areas are often hotter and more vulnerable due to lack of AC, some less dense, more affluent areas in Baltimore have older populations, who are also highly vulnerable to heat. A strategy optimizing purely for total mortality reduction might target these older populations in areas suitable for easy tree planting, even if it doesn't address the highest heat or poverty concentrations.</li>
            <li><strong>Cool Surfaces Advantage:</strong> Cool roofs and pavements can be applied more uniformly across dense urban areas where trees might be impractical, potentially offering more equitable cooling distribution in those specific contexts.</li>
        </ul>

        <div class="interactive-section">
            <h3>Strategy Focus and Equity Implications</h3>
            <p>Let's explore how the *focus* of an investment strategy might impact different neighborhood types and a simplified equity score. Adjust the slider to shift the hypothetical strategy focus between Greening and Infrastructure (Cool Surfaces). Observe how the investment distribution and equity score change.</p>
            <label for="strategyFocusSlider" class="form-label slider-label">Strategy Focus:</label>
            <input type="range" class="form-range" min="0" max="100" value="50" id="strategyFocusSlider">
            <div class="d-flex justify-content-between">
                <span>More Greening</span>
                <span>Balanced</span>
                <span>More Infrastructure</span>
            </div>
            <canvas id="equityInvestmentChart" style="margin-top: 1.5rem;"></canvas>
             <p class="caption">Hypothetical investment distribution across different neighborhood archetypes based on strategy focus.</p>
             <div class="alert alert-info mt-3" role="alert">
                 Simplified Equity Score: <span id="equityScore" class="fw-bold">0.75</span> (Lower score indicates higher disparity in investment between neighborhood types in this simple model).
             </div>
             <p><small><strong>Note:</strong> This is a highly simplified illustration. Real-world outcomes depend on many more factors than just strategy focus and available space. The key takeaway is that *how* and *where* investments are made is crucial for equity.</small></p>
        </div>

        <p>This doesn't mean trees are bad! It means that <span class="highlight">achieving equitable outcomes with greening strategies requires deliberate targeting and potentially higher investment</span> to overcome the challenges of planting in dense, underserved urban areas.</p>

        <h2>Dealing with an Uncertain Future: Climate Change</h2>
        <p>A major challenge in planning is <a class="term" href="https://en.wikipedia.org/wiki/Decision-making_under_deep_uncertainty" target="_blank">Deep Uncertainty</a> – we don't know exactly how much warmer the climate will get, or how frequent and intense future heatwaves will be. Should Baltimore plan for a moderate warming scenario or a high warming scenario? Planning for too little warming could leave the city unprepared, while planning for too much could lead to unnecessary spending.</p>
        <p>The paper tested this using City-HEAT's adaptive framework. The model uses <a class="term" href="https://en.wikipedia.org/wiki/Dynamic_adaptive_policy_pathways" target="_blank">Dynamic Adaptive Policy Pathways (DAPP)</a>. This means the strategies aren't fixed 50-year plans. Instead, they are sets of decision rules that adjust the level of investment over time based on observed conditions (like recent heatwave severity). This adaptiveness is implemented using a technique called <span class="term">Direct Policy Search (DPS)</span>, where the model optimizes the parameters of these decision rules. For example, a rule might look like:</p>
        $$ \text{Investment}_{i,j} = \text{Capacity}_{i,j} \times \frac{L}{1 + e^{-k \times (\text{HeatMetric}_i - x_0)}} $$
        <p>Where $\text{Investment}_{i,j}$ is the investment in strategy $j$ for neighborhood $i$, $\text{Capacity}_{i,j}$ is the maximum possible implementation, $\text{HeatMetric}_i$ is a measure of recent heat stress in neighborhood $i$, and $L, k, x_0$ are parameters optimized by the model defining the shape of the response curve (maximum investment, steepness, trigger point).</p>

        <p>The researchers trained the model separately: once assuming only low-warming future scenarios and once assuming only high-warming scenarios. They then tested how well each set of strategies performed under both expected and unexpected climate futures.</p>
        <p>The key finding was surprising: <span class="highlight">the best-performing adaptive strategies were remarkably similar, regardless of whether they were designed for low or high warming rates.</span> Strategies optimized for high warming weren't drastically more expensive overall than those optimized for low warming when simulated over 50 years, because the adaptive rules only ramped up investment significantly if high warming actually occurred.</p>

        <div class="interactive-section">
            <h3>Robustness to Climate Expectations</h3>
            <p>How well does a strategy perform if the future climate turns out differently than expected? We can represent this using a "Satisficing Score" – a measure of how often a strategy meets predefined performance criteria across many possible futures. A score of 1 is perfect, 0 is never meeting criteria.</p>
            <p>Adjust the sliders to see how the hypothetical satisficing score of different strategy *types* might change based on the climate they were designed for versus the climate that actually occurs. (Illustrative, based on trends in Figure 6).</p>
             <div class="row mb-3">
                <div class="col-md-6">
                    <label for="trainWarmingSlider" class="form-label slider-label">Climate Strategy Was Designed For:</label>
                    <input type="range" class="form-range" min="0" max="100" value="25" id="trainWarmingSlider">
                    <div class="d-flex justify-content-between">
                        <span>Low Warming</span>
                        <span>High Warming</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <label for="testWarmingSlider" class="form-label slider-label">Actual Future Climate Occurs:</label>
                    <input type="range" class="form-range" min="0" max="100" value="75" id="testWarmingSlider">
                     <div class="d-flex justify-content-between">
                        <span>Low Warming</span>
                        <span>High Warming</span>
                    </div>
                </div>
            </div>
             <canvas id="robustnessChart"></canvas>
             <p class="caption">Hypothetical Satisficing Scores for different strategy types under varying climate assumptions and outcomes.</p>
             <p><small>The paper suggests that while performance varies slightly, the *relative* ranking of strategy types (e.g., Balanced/Infrastructure often performing well on robustness metrics) and the overall structure of good strategies are less sensitive to climate assumptions than one might expect, thanks to the adaptive nature of the pathways.</small></p>
        </div>

        <h2>Key Takeaways</h2>
        <p>The City-HEAT analysis for Baltimore provides valuable insights for urban climate adaptation:</p>
        <ul>
            <li><strong>Trade-offs are unavoidable:</strong> There's no single perfect strategy. Planners must explicitly weigh costs, total health benefits, and equity.</li>
            <li><strong>Equity requires specific focus:</strong> Strategies that seem beneficial overall (like widespread tree planting) might worsen inequalities if not carefully targeted to vulnerable, underserved areas, potentially requiring higher costs or different approaches.</li>
            <li><strong>Balanced portfolios are often robust:</strong> Mixing infrastructure (cool surfaces) and greening, tailored to neighborhood conditions, often performs well across multiple objectives and potential futures.</li>
            <li><strong>Adaptive strategies handle uncertainty:</strong> Designing policies that can adjust over time based on observed conditions makes them more robust to unpredictable future climate change.</li>
            <li><strong>Models are conversation starters:</strong> Tools like City-HEAT, while complex, can illuminate hidden trade-offs and surprising outcomes, providing crucial input for community discussions and policy decisions.</li>
        </ul>

        <h2>Conclusion</h2>
        <p>Adapting our cities to extreme heat is a critical task for the 21st century. As the Eyni et al. paper demonstrates, it's a complex challenge involving multiple competing objectives, deep uncertainties, and crucial questions of fairness and equity. By using sophisticated modeling tools within a participatory planning process, cities can better understand the consequences of different choices and design adaptation pathways that are effective, robust, and benefit all residents.</p>

    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Inline JavaScript for Interactivity -->
    <script>
        // --- Chart 1: Cost vs Mortality ---
        const costMortalityCtx = document.getElementById('costMortalityChart').getContext('2d');
        // Sample data generation function (qualitative representation)
        function generateSampleData(numPoints) {
            const data = [];
            const types = ['Balanced/Moderate', 'Greening Focused', 'Infrastructure Focused', 'High Investment'];
            const colors = ['#36A2EB', '#4BC0C0', '#FFCE56', '#FF6384']; // Blue, Teal, Yellow, Red
            for (let i = 0; i < numPoints; i++) {
                const typeIndex = Math.floor(Math.random() * 4);
                let cost = Math.random() * 1000 + 18; // 18M to 1018M
                let mortalityReduction;

                // Base mortality reduction increases with cost, with diminishing returns
                mortalityReduction = 80 + (670 - 80) * (1 - Math.exp(-0.003 * (cost - 18)));
                mortalityReduction *= (0.8 + Math.random() * 0.4); // Add scatter

                // Adjust based on type (illustrative biases)
                if (types[typeIndex] === 'Infrastructure Focused') {
                    cost *= (0.6 + Math.random() * 0.3); // Tend to be lower cost
                    mortalityReduction *= (0.7 + Math.random() * 0.2); // Tend to have lower max reduction
                } else if (types[typeIndex] === 'Greening Focused') {
                    cost *= (0.9 + Math.random() * 0.3); // Can be expensive
                     mortalityReduction *= (0.9 + Math.random() * 0.2);
                } else if (types[typeIndex] === 'High Investment') {
                    cost *= (1.0 + Math.random() * 0.2); // Highest cost
                     mortalityReduction *= (1.0 + Math.random() * 0.1); // Highest reduction potential
                }

                // Ensure bounds
                cost = Math.max(18, Math.min(1023, cost));
                mortalityReduction = Math.max(81, Math.min(670, mortalityReduction));

                data.push({
                    x: cost,
                    y: mortalityReduction,
                    type: types[typeIndex],
                    color: colors[typeIndex],
                    unitCost: cost / mortalityReduction // M$ per life saved
                });
            }
             // Add specific representative points from Fig 2 for context
            data.push({ x: 200, y: 300, type: 'Infrastructure Focused', color: '#FFCE56', unitCost: 200/300 }); // Approx Infra point
            data.push({ x: 400, y: 450, type: 'Balanced/Moderate', color: '#36A2EB', unitCost: 400/450 }); // Approx Moderate point
            data.push({ x: 650, y: 550, type: 'Greening Focused', color: '#4BC0C0', unitCost: 650/550 }); // Approx Greening point
            data.push({ x: 900, y: 650, type: 'High Investment', color: '#FF6384', unitCost: 900/650 }); // Approx High All point

            return data;
        }
        const costMortalityData = generateSampleData(150);

        const costMortalityChart = new Chart(costMortalityCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Mitigation Pathways',
                    data: costMortalityData,
                    pointBackgroundColor: costMortalityData.map(p => p.color),
                    pointRadius: 5,
                    pointHoverRadius: 7
                }]
            },
            options: {
                scales: {
                    x: {
                        type: 'linear',
                        position: 'bottom',
                        title: {
                            display: true,
                            text: 'Total Cost (Million $)'
                        },
                        min: 0,
                        max: 1100
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Heat Deaths Averted (over 50 years)'
                        },
                        min: 0,
                        max: 700
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const point = context.raw;
                                return `${point.type}: Cost $${point.x.toFixed(0)}M, Saved ${point.y.toFixed(0)} lives, Unit Cost: $${point.unitCost.toFixed(2)}M/life`;
                            }
                        }
                    },
                     legend: { display: false }
                }
            }
        });

        // --- Chart 2: Mortality vs Equity ---
        const mortalityEquityCtx = document.getElementById('mortalityEquityChart').getContext('2d');

        function generateEquityData(costMortalityData) {
             return costMortalityData.map(point => {
                 let equityDiff = 550 - (point.y / 670) * 250; // Base equity improves with mortality reduction
                 equityDiff *= (0.8 + Math.random() * 0.4); // Add scatter

                 // Adjust based on type (illustrative biases from paper)
                 if (point.type === 'Infrastructure Focused' || point.type === 'Balanced/Moderate') {
                     equityDiff *= (0.7 + Math.random() * 0.2); // Tend to be better equity (lower difference)
                 } else if (point.type === 'Greening Focused' || point.type === 'High Investment') {
                     equityDiff *= (1.0 + Math.random() * 0.4); // Tend to be worse equity (higher difference)
                 }
                 // Ensure bounds (approx range from Fig 2c)
                 equityDiff = Math.max(380, Math.min(550, equityDiff));

                 return {
                     x: point.y, // Mortality Reduction on X axis
                     y: equityDiff, // Equity difference on Y axis
                     type: point.type,
                     color: point.color,
                     cost: point.x
                 };
             });
        }
        const mortalityEquityData = generateEquityData(costMortalityData);

        const mortalityEquityChart = new Chart(mortalityEquityCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Mitigation Pathways',
                    data: mortalityEquityData,
                    pointBackgroundColor: mortalityEquityData.map(p => p.color),
                    pointRadius: 5,
                    pointHoverRadius: 7
                }]
            },
            options: {
                scales: {
                    x: {
                        type: 'linear',
                        position: 'bottom',
                        title: {
                            display: true,
                            text: 'Heat Deaths Averted (over 50 years)'
                        },
                         min: 0,
                         max: 700
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Max Mortality Rate Difference (per 100k, Higher = Worse Equity)'
                        },
                        min: 350,
                        max: 600
                    }
                },
                 plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const point = context.raw;
                                return `${point.type}: Saved ${point.x.toFixed(0)} lives, Equity Diff: ${point.y.toFixed(0)}, Cost $${point.cost.toFixed(0)}M`;
                            }
                        }
                    },
                    legend: { display: false }
                }
            }
        });


        // --- Chart 3: Equity Investment ---
        const equityInvestmentCtx = document.getElementById('equityInvestmentChart').getContext('2d');
        const strategyFocusSlider = document.getElementById('strategyFocusSlider');
        const equityScoreSpan = document.getElementById('equityScore');

        const equityInvestmentChart = new Chart(equityInvestmentCtx, {
            type: 'bar',
            data: {
                labels: ['Poorer / Denser / Less Space', 'Middle Income / Mixed', 'Affluent / Older / More Space'],
                datasets: [{
                    label: 'Hypothetical Investment %',
                    data: [33.3, 33.3, 33.3], // Initial balanced state
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.6)', // Reddish
                        'rgba(54, 162, 235, 0.6)', // Blueish
                        'rgba(75, 192, 192, 0.6)'  // Greenish
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(75, 192, 192, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y', // Horizontal bars
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 60, // Allow some imbalance display
                        title: { display: true, text: 'Share of Investment (%)' }
                    },
                    y: {
                         ticks: { font: { size: 10 } } // Smaller labels if needed
                    }
                },
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: 'Investment Distribution by Neighborhood Archetype' }
                }
            }
        });

        function updateEquityChart() {
            const focus = parseInt(strategyFocusSlider.value); // 0 = Greening, 100 = Infrastructure
            const greeningBias = (100 - focus) / 100; // 1 when focus=0, 0 when focus=100
            const infrastructureBias = focus / 100; // 0 when focus=0, 1 when focus=100

            // Simple model: Greening favors 'Affluent/More Space', Infrastructure favors 'Poorer/Denser'
            // Let base be 1/3 each. Add bias, then normalize.
            let investment = [
                (1/3) + 0.4 * infrastructureBias - 0.2 * greeningBias, // Poorer/Denser
                (1/3) - 0.1 * infrastructureBias - 0.1 * greeningBias, // Middle
                (1/3) - 0.2 * infrastructureBias + 0.4 * greeningBias  // Affluent/Greener
            ];

            // Ensure non-negative and normalize to sum to 1 (representing 100%)
            investment = investment.map(val => Math.max(0, val));
            const total = investment.reduce((sum, val) => sum + val, 0);
            const normalizedInvestment = investment.map(val => (val / total) * 100);

            equityInvestmentChart.data.datasets[0].data = normalizedInvestment;
            equityInvestmentChart.update();

            // Update simplified equity score (e.g., 1 - range/average, scaled)
            const maxInv = Math.max(...normalizedInvestment);
            const minInv = Math.min(...normalizedInvestment);
            const avgInv = 100 / 3;
            // Score closer to 1 is better (less disparity)
            const score = 1 - (maxInv - minInv) / (maxInv + minInv + 0.1); // Avoid div by zero, scale 0-1 ish
            equityScoreSpan.textContent = score.toFixed(2);
        }

        strategyFocusSlider.addEventListener('input', updateEquityChart);
        updateEquityChart(); // Initial call


        // --- Chart 4: Robustness ---
        const robustnessCtx = document.getElementById('robustnessChart').getContext('2d');
        const trainWarmingSlider = document.getElementById('trainWarmingSlider');
        const testWarmingSlider = document.getElementById('testWarmingSlider');

        const strategyTypesRobustness = ['Balanced/Moderate', 'Greening Focused', 'Infrastructure Focused', 'High Investment'];
        const baseColorsRobustness = ['#36A2EB', '#4BC0C0', '#FFCE56', '#FF6384'];

        const robustnessChart = new Chart(robustnessCtx, {
            type: 'bar',
            data: {
                labels: strategyTypesRobustness,
                datasets: [{
                    label: 'Satisficing Score',
                    data: [0.7, 0.6, 0.75, 0.65], // Initial scores
                    backgroundColor: baseColorsRobustness,
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1,
                        title: { display: true, text: 'Satisficing Score (Higher is Better)' }
                    }
                },
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: 'Strategy Robustness Under Climate Scenarios' }
                }
            }
        });

        function updateRobustnessChart() {
            const trainLevel = parseInt(trainWarmingSlider.value) / 100; // 0=Low, 1=High
            const testLevel = parseInt(testWarmingSlider.value) / 100; // 0=Low, 1=High
            const mismatch = Math.abs(trainLevel - testLevel); // 0=Match, 1=Max Mismatch

            const newScores = strategyTypesRobustness.map(type => {
                let baseScore;
                // Assign slightly different base scores based on general findings
                if (type === 'Infrastructure Focused' || type === 'Balanced/Moderate') {
                    baseScore = 0.7 + Math.random() * 0.1; // Tend to be more robust
                } else {
                    baseScore = 0.6 + Math.random() * 0.1; // Less robust maybe
                }

                // Reduce score based on mismatch, but not drastically (paper finding)
                const penalty = mismatch * (0.1 + Math.random() * 0.15); // Small penalty for mismatch
                let finalScore = baseScore - penalty;

                // Add a small bonus if testLevel is high (more challenge reveals robustness?)
                 if (testLevel > 0.7) finalScore += 0.05;

                return Math.max(0.3, Math.min(0.95, finalScore)); // Keep scores reasonable
            });

            robustnessChart.data.datasets[0].data = newScores;
            robustnessChart.update();
        }

        trainWarmingSlider.addEventListener('input', updateRobustnessChart);
        testWarmingSlider.addEventListener('input', updateRobustnessChart);
        updateRobustnessChart(); // Initial call

    </script>

</body>
</html>